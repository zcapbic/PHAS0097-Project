# Sample LAMMPS input script for thermal conductivity of solid Ar
# Modified to calculate phonon dispersion relations instead of thermal conductivity

units       real
atom_style  atomic
atom_modify map array

variable run_no equal 0
variable res_no equal ${run_no}-1

variable iseed0 equal 2357  
variable iseed1 equal 26488 
variable iseed2 equal 10669 
processors      * * *

variable inpfile string datafile.txt
variable resfile string final_restart.${res_no}
variable ff_file string forcefield.txt

variable minimise equal    0   #Energy Minimization
neighbor 1 bin

variable mtraj    equal        1       # trajectory output frequency - all system
variable etol     equal     1e-5       # % change in energy
variable ftol     equal     1e-5       # max force threshold (force units)
variable maxiter  equal    10000       # max # of iterations

boundary 	p p p

if "${run_no} == 0" then "read_data ${inpfile}" else "read_restart ${resfile}"

include ${ff_file}

variable str_basic string 'step time pe temp press'

#####################
#Energy Minimization#
#####################
if "${minimise} <= 0 || ${run_no} > 0" then "jump SELF end_minimise"
  print "Doing CG minimisation"
  dump mdcd all dcd ${mtraj} min.dcd
  dump_modify mdcd unwrap yes
  min_style cg
  min_modify line quadratic
  minimize ${etol} ${ftol} ${maxiter} ${maxiter}
  reset_timestep 0
  undump mdcd
label end_minimise


dynamical_matrix all eskm 0.0001 file dynmat.dat binary no

