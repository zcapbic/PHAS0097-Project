##### Computing the thermal conductivity of Argon

### Initialisation of units, boundaries
units		real
atom_style	atomic
newton		on
dimension	3
boundary 	p p p

### Set variables
variable	boltzmann equal 1.380649e-23 				# Joules/Kelvin
variable	eV equal 1.60218e-19					# Joules
variable	kcal equal 4184						# Joules
variable	avogadro equal 6.0221408e+23				# 1/Mol

## Lennard Jones parameters
variable	sigma equal 3.405 					# Angstroms
variable	epsilon equal ((0.0104*v_eV/v_kcal) * v_avogadro)	# kcal/mol

## Thermal conduction parameters
variable        t equal 1.35
variable    	p equal 200     					# correlation length
variable    	s equal 10      					# sample interval
variable    	d equal $p*$s   					# dump interval


### Set up lattice
lattice		fcc	5.256
region box 	block	0 10	0 10	0 10
create_box 	1 box
create_atoms 	1 box
mass		1 39.948

velocity        all create $t 87287

### Lennard Jones pairing
pair_style	lj/cut 10.0
pair_coeff	* * ${epsilon} ${sigma} 10.0


### Remainder was copied from KAPPA examples in folders
# 1st equilibration run

fix             1 all nvt temp $t $t 0.5
thermo          100
run             1000

velocity        all scale $t

unfix           1

# thermal conductivity calculation

reset_timestep  0

compute         myKE all ke/atom
compute         myPE all pe/atom
compute         myStress all stress/atom NULL virial
compute         flux all heat/flux myKE myPE myStress
variable        Jx equal c_flux[1]/vol
variable        Jy equal c_flux[2]/vol
variable        Jz equal c_flux[3]/vol

fix             1 all nve
fix             JJ all ave/correlate $s $p $d &
                c_flux[1] c_flux[2] c_flux[3] type auto &
                file profile.heatflux ave running

variable        scale equal $s*dt/$t/$t/vol
variable        k11 equal trap(f_JJ[3])*${scale}
variable        k22 equal trap(f_JJ[4])*${scale}
variable        k33 equal trap(f_JJ[5])*${scale}
variable        kappa equal (v_k11+v_k22+v_k33)/3.0

thermo          $d
thermo_style    custom step temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33 v_kappa
thermo_modify   colname v_Jx Jx colname v_Jy Jy colname v_Jz Jz &
                colname v_k11 kappa_11 colname v_k22 kappa_22 &
                colname v_k33 kappa_33 colname v_kappa kappa

run             100000

print           "Running average thermal conductivity: $(v_kappa:%.2f)"










